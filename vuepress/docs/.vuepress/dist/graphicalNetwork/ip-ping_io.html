<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>断网了，还能 ping 通 127.0.0.1 吗？ | </title><meta name="description" content="">
    <link rel="modulepreload" href="/assets/app.c62ce33e.js"><link rel="modulepreload" href="/assets/ip-ping_io.html.ebe3c32c.js"><link rel="modulepreload" href="/assets/ip-ping_io.html.6c34496f.js"><link rel="prefetch" href="/assets/1.1.hello-world.html.c9c3a5a1.js"><link rel="prefetch" href="/assets/1.10.if.html.9e1b96da.js"><link rel="prefetch" href="/assets/1.11.includes.html.f730fd82.js"><link rel="prefetch" href="/assets/1.12.parameters.html.cea6009c.js"><link rel="prefetch" href="/assets/1.13.push.html.b4a2eefb.js"><link rel="prefetch" href="/assets/1.14.unshift.html.899e4793.js"><link rel="prefetch" href="/assets/1.2.Pick.html.00955fc1.js"><link rel="prefetch" href="/assets/1.3.Awaited.html.c28eb4dc.js"><link rel="prefetch" href="/assets/1.4.Readonly.html.5504219f.js"><link rel="prefetch" href="/assets/1.5.Tuple-to-object.html.e5ff4876.js"><link rel="prefetch" href="/assets/1.6.First-of-array.html.8963da96.js"><link rel="prefetch" href="/assets/1.7.Length-of-Tuple.html.b566373d.js"><link rel="prefetch" href="/assets/1.8.concat.html.e48cdb0f.js"><link rel="prefetch" href="/assets/1.9.exclude.html.a9065b1a.js"><link rel="prefetch" href="/assets/2.1.Get-Return-Type.html.fc63429d.js"><link rel="prefetch" href="/assets/2.2.omit.html.12f10b17.js"><link rel="prefetch" href="/assets/2.3.Readonly2.html.e66ac73b.js"><link rel="prefetch" href="/assets/2.4.Deep-Readonly.html.a658e6e6.js"><link rel="prefetch" href="/assets/2.5.turn-to-union.html.073cd259.js"><link rel="prefetch" href="/assets/3.1.Simple-Vue.html.99882d01.js"><link rel="prefetch" href="/assets/donate.html.acbabecd.js"><link rel="prefetch" href="/assets/Routine1_pattern-matching-for-extraction.html.875abc65.js"><link rel="prefetch" href="/assets/basic-1.html.9eb41d9a.js"><link rel="prefetch" href="/assets/basic-2.html.f7caa9d2.js"><link rel="prefetch" href="/assets/basic-3.html.34aee1eb.js"><link rel="prefetch" href="/assets/http-2.html.787a8a96.js"><link rel="prefetch" href="/assets/http-3.html.34a30fe1.js"><link rel="prefetch" href="/assets/http-interview.html.ace5bf96.js"><link rel="prefetch" href="/assets/http-optimize.html.69d45db9.js"><link rel="prefetch" href="/assets/http-rpc.html.8491156f.js"><link rel="prefetch" href="/assets/http-websocket.html.7d4a1447.js"><link rel="prefetch" href="/assets/https-ecdhe.html.05368a85.js"><link rel="prefetch" href="/assets/https-optimize.html.6a75aeb7.js"><link rel="prefetch" href="/assets/https-rsa.html.f131cf25.js"><link rel="prefetch" href="/assets/ip-base.html.e6127d4e.js"><link rel="prefetch" href="/assets/ip-ping.html.6302a945.js"><link rel="prefetch" href="/assets/tcp-challenge-ack.html.3a5fc045.js"><link rel="prefetch" href="/assets/tcp-dump.html.b56080fb.js"><link rel="prefetch" href="/assets/tcp-feature.html.a3d828ae.js"><link rel="prefetch" href="/assets/tcp-interview.html.62d97690.js"><link rel="prefetch" href="/assets/tcp-isn-deff.html.82d20436.js"><link rel="prefetch" href="/assets/tcp-optimize.html.ca87f13b.js"><link rel="prefetch" href="/assets/tcp-out-of-order-fin.html.151c009d.js"><link rel="prefetch" href="/assets/tcp-queue.html.74d5129c.js"><link rel="prefetch" href="/assets/tcp-stream.html.e93bfa43.js"><link rel="prefetch" href="/assets/tcp-syn.html.d732a2c4.js"><link rel="prefetch" href="/assets/Advanced-1.html.fa0fc3db.js"><link rel="prefetch" href="/assets/Advanced-2.html.768f0222.js"><link rel="prefetch" href="/assets/Advanced-3.html.80ef5874.js"><link rel="prefetch" href="/assets/Advanced-4.html.9ac82786.js"><link rel="prefetch" href="/assets/Advanced-5.html.7086659b.js"><link rel="prefetch" href="/assets/base-1.html.a1a4a8f1.js"><link rel="prefetch" href="/assets/base-10.html.5a196727.js"><link rel="prefetch" href="/assets/base-11.html.aab11d1b.js"><link rel="prefetch" href="/assets/base-12.html.e5e162d6.js"><link rel="prefetch" href="/assets/base-13.html.e7f1ec06.js"><link rel="prefetch" href="/assets/base-14.html.7817c35c.js"><link rel="prefetch" href="/assets/base-15.html.234b3135.js"><link rel="prefetch" href="/assets/base-16.html.d8b75899.js"><link rel="prefetch" href="/assets/base-17.html.563cf78a.js"><link rel="prefetch" href="/assets/base-2.html.a766b26b.js"><link rel="prefetch" href="/assets/base-3.html.456ded6f.js"><link rel="prefetch" href="/assets/base-4.html.ad7f3656.js"><link rel="prefetch" href="/assets/base-5.html.d39095e5.js"><link rel="prefetch" href="/assets/base-6.html.b84ee494.js"><link rel="prefetch" href="/assets/base-7.html.178e9a4d.js"><link rel="prefetch" href="/assets/base-8.html.c0808088.js"><link rel="prefetch" href="/assets/base-9.html.208c7bb9.js"><link rel="prefetch" href="/assets/rollup-1.html.03002012.js"><link rel="prefetch" href="/assets/rollup-10.html.86a22541.js"><link rel="prefetch" href="/assets/rollup-11.html.e3a4642f.js"><link rel="prefetch" href="/assets/rollup-2.html.41d6ac3a.js"><link rel="prefetch" href="/assets/rollup-3.html.6ad17f68.js"><link rel="prefetch" href="/assets/rollup-4.html.7d4a4c3c.js"><link rel="prefetch" href="/assets/rollup-5.html.54596415.js"><link rel="prefetch" href="/assets/rollup-6.html.2de6134f.js"><link rel="prefetch" href="/assets/rollup-7.html.e1bb8ffd.js"><link rel="prefetch" href="/assets/rollup-8.html.1b8764c3.js"><link rel="prefetch" href="/assets/rollup-9.html.1d7bff01.js"><link rel="prefetch" href="/assets/scope-closures-appA.html.54460362.js"><link rel="prefetch" href="/assets/scope-closures-appB.html.df5a960f.js"><link rel="prefetch" href="/assets/scope-closures-appC.html.d19041c8.js"><link rel="prefetch" href="/assets/this-object-prototype-appA.html.a5e33133.js"><link rel="prefetch" href="/assets/async-performance-apA.html.1318a5e9.js"><link rel="prefetch" href="/assets/async-performance-apB.html.6a42c749.js"><link rel="prefetch" href="/assets/async-performance-ch1.html.43644825.js"><link rel="prefetch" href="/assets/async-performance-ch2.html.5569a916.js"><link rel="prefetch" href="/assets/async-performance-ch3.html.6eb4b5e0.js"><link rel="prefetch" href="/assets/async-performance-ch4.html.b1839a56.js"><link rel="prefetch" href="/assets/async-performance-ch5.html.9bd4d678.js"><link rel="prefetch" href="/assets/async-performance-ch6.html.04dbdb45.js"><link rel="prefetch" href="/assets/types-grammar-1.html.4b5e4a6d.js"><link rel="prefetch" href="/assets/types-grammar-2.html.09993b1d.js"><link rel="prefetch" href="/assets/types-grammar-3.html.d901835c.js"><link rel="prefetch" href="/assets/types-grammar-4.html.e85d4a5d.js"><link rel="prefetch" href="/assets/types-grammar-5.html.a2b81328.js"><link rel="prefetch" href="/assets/types-grammar-apA.html.2924c653.js"><link rel="prefetch" href="/assets/404.html.d2dc3323.js"><link rel="prefetch" href="/assets/1.1.hello-world.html.f87c5e3d.js"><link rel="prefetch" href="/assets/1.10.if.html.77dc3aac.js"><link rel="prefetch" href="/assets/1.11.includes.html.6373ae78.js"><link rel="prefetch" href="/assets/1.12.parameters.html.9058ff22.js"><link rel="prefetch" href="/assets/1.13.push.html.ce608075.js"><link rel="prefetch" href="/assets/1.14.unshift.html.a931245a.js"><link rel="prefetch" href="/assets/1.2.Pick.html.dff96be2.js"><link rel="prefetch" href="/assets/1.3.Awaited.html.81dda58f.js"><link rel="prefetch" href="/assets/1.4.Readonly.html.36238f2d.js"><link rel="prefetch" href="/assets/1.5.Tuple-to-object.html.0b0099ac.js"><link rel="prefetch" href="/assets/1.6.First-of-array.html.00beb244.js"><link rel="prefetch" href="/assets/1.7.Length-of-Tuple.html.f88876ce.js"><link rel="prefetch" href="/assets/1.8.concat.html.8589b1fe.js"><link rel="prefetch" href="/assets/1.9.exclude.html.bc7e747b.js"><link rel="prefetch" href="/assets/2.1.Get-Return-Type.html.cac3876c.js"><link rel="prefetch" href="/assets/2.2.omit.html.f3a4349f.js"><link rel="prefetch" href="/assets/2.3.Readonly2.html.1737beae.js"><link rel="prefetch" href="/assets/2.4.Deep-Readonly.html.0b245458.js"><link rel="prefetch" href="/assets/2.5.turn-to-union.html.0c299433.js"><link rel="prefetch" href="/assets/3.1.Simple-Vue.html.55f2fe53.js"><link rel="prefetch" href="/assets/donate.html.5cb41655.js"><link rel="prefetch" href="/assets/Routine1_pattern-matching-for-extraction.html.6c98f4ad.js"><link rel="prefetch" href="/assets/basic-1.html.6a860dd6.js"><link rel="prefetch" href="/assets/basic-2.html.a6d0227e.js"><link rel="prefetch" href="/assets/basic-3.html.4aa3975b.js"><link rel="prefetch" href="/assets/http-2.html.6c62ded8.js"><link rel="prefetch" href="/assets/http-3.html.ca8b3092.js"><link rel="prefetch" href="/assets/http-interview.html.0e6a6925.js"><link rel="prefetch" href="/assets/http-optimize.html.b4e1bb6a.js"><link rel="prefetch" href="/assets/http-rpc.html.fd6c7486.js"><link rel="prefetch" href="/assets/http-websocket.html.2432d335.js"><link rel="prefetch" href="/assets/https-ecdhe.html.e93a5f88.js"><link rel="prefetch" href="/assets/https-optimize.html.dc41471a.js"><link rel="prefetch" href="/assets/https-rsa.html.daa108b5.js"><link rel="prefetch" href="/assets/ip-base.html.086353f5.js"><link rel="prefetch" href="/assets/ip-ping.html.68033e75.js"><link rel="prefetch" href="/assets/tcp-challenge-ack.html.68ead87a.js"><link rel="prefetch" href="/assets/tcp-dump.html.2de8cf1a.js"><link rel="prefetch" href="/assets/tcp-feature.html.c5a127db.js"><link rel="prefetch" href="/assets/tcp-interview.html.831f8b91.js"><link rel="prefetch" href="/assets/tcp-isn-deff.html.4c6f47e5.js"><link rel="prefetch" href="/assets/tcp-optimize.html.19aa5ce4.js"><link rel="prefetch" href="/assets/tcp-out-of-order-fin.html.facde3d7.js"><link rel="prefetch" href="/assets/tcp-queue.html.451a24bd.js"><link rel="prefetch" href="/assets/tcp-stream.html.222e0df4.js"><link rel="prefetch" href="/assets/tcp-syn.html.e6bc0339.js"><link rel="prefetch" href="/assets/Advanced-1.html.6349fdad.js"><link rel="prefetch" href="/assets/Advanced-2.html.3b4a022c.js"><link rel="prefetch" href="/assets/Advanced-3.html.080f2ab9.js"><link rel="prefetch" href="/assets/Advanced-4.html.9638a4d7.js"><link rel="prefetch" href="/assets/Advanced-5.html.665e8357.js"><link rel="prefetch" href="/assets/base-1.html.7cc0b90c.js"><link rel="prefetch" href="/assets/base-10.html.69d523e6.js"><link rel="prefetch" href="/assets/base-11.html.66768537.js"><link rel="prefetch" href="/assets/base-12.html.57a64e53.js"><link rel="prefetch" href="/assets/base-13.html.bbc769c9.js"><link rel="prefetch" href="/assets/base-14.html.58215026.js"><link rel="prefetch" href="/assets/base-15.html.59b22684.js"><link rel="prefetch" href="/assets/base-16.html.3887a292.js"><link rel="prefetch" href="/assets/base-17.html.b0178761.js"><link rel="prefetch" href="/assets/base-2.html.fb30aa47.js"><link rel="prefetch" href="/assets/base-3.html.b2afde71.js"><link rel="prefetch" href="/assets/base-4.html.ef59e9ed.js"><link rel="prefetch" href="/assets/base-5.html.2ca82580.js"><link rel="prefetch" href="/assets/base-6.html.1b0ab37b.js"><link rel="prefetch" href="/assets/base-7.html.89963722.js"><link rel="prefetch" href="/assets/base-8.html.5bd91515.js"><link rel="prefetch" href="/assets/base-9.html.905d119d.js"><link rel="prefetch" href="/assets/rollup-1.html.6b56ddc8.js"><link rel="prefetch" href="/assets/rollup-10.html.b8bdb04e.js"><link rel="prefetch" href="/assets/rollup-11.html.7bac1960.js"><link rel="prefetch" href="/assets/rollup-2.html.40921e40.js"><link rel="prefetch" href="/assets/rollup-3.html.c53b9c22.js"><link rel="prefetch" href="/assets/rollup-4.html.1a3cf109.js"><link rel="prefetch" href="/assets/rollup-5.html.eea45fb7.js"><link rel="prefetch" href="/assets/rollup-6.html.24eed356.js"><link rel="prefetch" href="/assets/rollup-7.html.7e3895d9.js"><link rel="prefetch" href="/assets/rollup-8.html.a4414797.js"><link rel="prefetch" href="/assets/rollup-9.html.40576d10.js"><link rel="prefetch" href="/assets/scope-closures-appA.html.686c3731.js"><link rel="prefetch" href="/assets/scope-closures-appB.html.ae1a70af.js"><link rel="prefetch" href="/assets/scope-closures-appC.html.beda04da.js"><link rel="prefetch" href="/assets/this-object-prototype-appA.html.1d350ec3.js"><link rel="prefetch" href="/assets/async-performance-apA.html.fc474119.js"><link rel="prefetch" href="/assets/async-performance-apB.html.9c5fb979.js"><link rel="prefetch" href="/assets/async-performance-ch1.html.391cfd51.js"><link rel="prefetch" href="/assets/async-performance-ch2.html.68f1ca43.js"><link rel="prefetch" href="/assets/async-performance-ch3.html.f7b1aea8.js"><link rel="prefetch" href="/assets/async-performance-ch4.html.eab53c5c.js"><link rel="prefetch" href="/assets/async-performance-ch5.html.4625ed62.js"><link rel="prefetch" href="/assets/async-performance-ch6.html.558fb103.js"><link rel="prefetch" href="/assets/types-grammar-1.html.dda1c4aa.js"><link rel="prefetch" href="/assets/types-grammar-2.html.97b42ac4.js"><link rel="prefetch" href="/assets/types-grammar-3.html.53926110.js"><link rel="prefetch" href="/assets/types-grammar-4.html.6c8ab89f.js"><link rel="prefetch" href="/assets/types-grammar-5.html.f0fdc94e.js"><link rel="prefetch" href="/assets/types-grammar-apA.html.a9ef0801.js"><link rel="prefetch" href="/assets/404.html.99e92f7a.js">
    <link rel="stylesheet" href="/assets/style.f4d22aab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><!--v-if--></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">断网了，还能 ping 通 127.0.0.1 吗？ <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#什么是127-0-0-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是127.0.0.1"><!--[--><!--]--> 什么是127.0.0.1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#什么是-ping" class="router-link-active router-link-exact-active sidebar-item" aria-label="什么是 ping"><!--[--><!--]--> 什么是 ping <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#tcp发数据和ping的区别" class="router-link-active router-link-exact-active sidebar-item" aria-label="TCP发数据和ping的区别"><!--[--><!--]--> TCP发数据和ping的区别 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#为什么断网了还能-ping-通-127-0-0-1" class="router-link-active router-link-exact-active sidebar-item" aria-label="为什么断网了还能 ping 通 127.0.0.1"><!--[--><!--]--> 为什么断网了还能 ping 通 127.0.0.1 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#ping回环地址和ping本机地址有什么区别" class="router-link-active router-link-exact-active sidebar-item" aria-label="ping回环地址和ping本机地址有什么区别"><!--[--><!--]--> ping回环地址和ping本机地址有什么区别 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#_127-0-0-1-和-localhost-以及-0-0-0-0-有区别吗" class="router-link-active router-link-exact-active sidebar-item" aria-label="127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗"><!--[--><!--]--> 127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/graphicalNetwork/ip-ping_io.html#总结" class="router-link-active router-link-exact-active sidebar-item" aria-label="总结"><!--[--><!--]--> 总结 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="断网了-还能-ping-通-127-0-0-1-吗" tabindex="-1"><a class="header-anchor" href="#断网了-还能-ping-通-127-0-0-1-吗" aria-hidden="true">#</a> 断网了，还能 ping 通 127.0.0.1 吗？</h1><p>你<strong>女神爱不爱你</strong>，你问她，她可能不会告诉你。</p><p>但<strong>网通不通</strong>，你 <code>ping</code> 一下就知道了。</p><p>可能看到标题，你就知道答案了，但是你了解背后的原因吗？</p><p>那如果把 <code>127.0.0.1</code> 换成 <code>0.0.0.0</code> 或 <code>localhost</code> 会怎么样呢？你知道这几个<code>IP</code>有什么区别吗？</p><p>以前面试的时候就遇到过这个问题，大家看个动图了解下面试官和我当时的场景，求当时我的心里阴影面积。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/c3a97f36607c0e7ef6805bfba482a060.gif" alt="图片"></p><p>话不多说，我们直接开车。</p><p>拔掉网线，断网。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/5137bc7bce08dc60cfa2f8152b738dfd.jpeg" alt="图片"></p><p>然后在控制台输入<code>ping 127.0.0.1</code>。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ping</span> <span class="token number">127.0</span>.0.1
PING <span class="token number">127.0</span>.0.1 <span class="token punctuation">(</span><span class="token number">127.0</span>.0.1<span class="token punctuation">)</span>: <span class="token number">56</span> data bytes
<span class="token number">64</span> bytes from <span class="token number">127.0</span>.0.1: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">0</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.080</span> ms
<span class="token number">64</span> bytes from <span class="token number">127.0</span>.0.1: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">1</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.093</span> ms
<span class="token number">64</span> bytes from <span class="token number">127.0</span>.0.1: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">2</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.074</span> ms
<span class="token number">64</span> bytes from <span class="token number">127.0</span>.0.1: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">3</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.079</span> ms
<span class="token number">64</span> bytes from <span class="token number">127.0</span>.0.1: <span class="token assign-left variable">icmp_seq</span><span class="token operator">=</span><span class="token number">4</span> <span class="token assign-left variable">ttl</span><span class="token operator">=</span><span class="token number">64</span> <span class="token assign-left variable">time</span><span class="token operator">=</span><span class="token number">0.079</span> ms
^C
--- <span class="token number">127.0</span>.0.1 <span class="token function">ping</span> statistics ---
<span class="token number">5</span> packets transmitted, <span class="token number">5</span> packets received, <span class="token number">0.0</span>% packet loss
round-trip min/avg/max/stddev <span class="token operator">=</span> <span class="token number">0.074</span>/0.081/0.093/0.006 ms
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>说明，拔了网线，<code>ping 127.0.0.1</code> 是<strong>能ping通的</strong>。</p><p>其实这篇文章看到这里，标题前半个问题已经被回答了。但是我们可以再想深一点。</p><p>为什么断网了还能 <code>ping</code> 通 <code>127.0.0.1</code> 呢？</p><p><strong>这能说明你不用交网费就能上网吗？</strong></p><p><strong>不能。</strong></p><p>首先我们需要进入基础科普环节。</p><p>不懂的同学看了就懂了，懂的看了就当查漏补缺吧。</p><h2 id="什么是127-0-0-1" tabindex="-1"><a class="header-anchor" href="#什么是127-0-0-1" aria-hidden="true">#</a> 什么是127.0.0.1</h2><p>首先，这是个 <code>IPV4</code> 地址。</p><p><code>IPV4</code> 地址有 <code>32</code> 位，一个字节有 <code>8</code> 位，共 <code>4</code> 个字节。</p><p>其中<strong>127 开头的都属于回环地址</strong>，也是 <code>IPV4</code> 的特殊地址，没什么道理，就是人为规定的。</p><p>而<code>127.0.0.1</code>是<strong>众多</strong>回环地址中的一个。之所以不是 <code>127.0.0.2</code> ，而是 <code>127.0.0.1</code>，是因为源码里就是这么定义的，也没什么道理。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">/* Address to loopback in software to local host.  */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>    <span class="token macro-name">INADDR_LOOPBACK</span>     <span class="token expression"><span class="token number">0x7f000001</span>  </span><span class="token comment">/* 127.0.0.1   */</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://img-blog.csdnimg.cn/img_convert/fa904fbcf66cc7abf510a8dc16f867fa.png" alt="图片"></p><p><code>IPv4</code> 的地址是 <code>32</code> 位的，2的32次方，大概是<code>40+亿</code>。地球光人口就76亿了，40亿IP这点量，<strong>塞牙缝都不够</strong>，实际上<strong>IP也确实用完</strong>了。</p><p>所以就有了<code>IPV6</code>， <code>IPv6</code> 的地址是 <code>128</code> 位的，大概是2的128次方≈<strong>10的38次方</strong>。据说地球的沙子数量大概是 <strong>10的23次方</strong>，所以IPV6的IP可以认为用不完。</p><p>IPV4以8位一组，每组之间用 <strong>.</strong> 号隔开。</p><p>IPV6就以16位为一组，每组之间用 <strong>:</strong> 号隔开。如果全是0，那么可以省略不写。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/e841adeeecf9451e1aca296d5c7a7f30.png" alt="图片"></p><p>在IPV4下的回环地址是 <code>127.0.0.1</code>，在<code>IPV6</code>下，表达为 <code>::1</code> 。中间把<strong>连续的0</strong>给省略了，之所以不是<strong>7个 冒号</strong>，而是<strong>2个冒号:</strong> ， 是因为一个 IPV6 地址中<strong>只允许出现⼀次两个连续的冒号</strong>。</p><blockquote><p>多说一句：在IPV4下用的是 <strong>ping 127.0.0.1</strong> 命令。在IPV6下用的是 <strong>ping6 ::1</strong> 命令。</p></blockquote><h2 id="什么是-ping" tabindex="-1"><a class="header-anchor" href="#什么是-ping" aria-hidden="true">#</a> 什么是 ping</h2><p>ping 是应用层命令，可以理解为它跟游戏或者聊天软件属于同一层。只不过聊天软件可以收发消息，还能点个赞什么的，有很多复杂的功能。而 ping 作为一个小软件，它的功能比较简单，就是<strong>尝试</strong>发送一个小小的消息到目标机器上，判断目的机器是否<strong>可达</strong>，其实也就是判断目标机器网络是否能连通。</p><p>ping应用的底层，用的是网络层的<strong>ICMP协议</strong>。</p><p>IP和ICMP和Ping所在分层</p><p>虽然ICMP协议和IP协议<strong>都属于网络层协议</strong>，但其实<strong>ICMP也是利用了IP协议进行消息的传输</strong>。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/8e0aba146432baeb407ab445292c8019.png" alt="图片"></p><p>所以，大家在这里完全可以简单的理解为 ping 某个IP 就是往某个IP地址发个消息。</p><h2 id="tcp发数据和ping的区别" tabindex="-1"><a class="header-anchor" href="#tcp发数据和ping的区别" aria-hidden="true">#</a> TCP发数据和ping的区别</h2><p>一般情况下，我们会使用 TCP 进行网络数据传输，那么我们可以看下它和 ping 的区别。</p><p><em>PS：下图中有一处画错了，右边是 tcp 数据，而不是 ping 数据，我偷懒就不重画了</em>。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/eb0963a11439dff361dbe0e7a8876abd.png" alt="图片"></p><p>ping和其他应用层软件都属于<strong>应用层</strong>。</p><p>那么我们横向对比一下，比方说聊天软件，如果用的是TCP的方式去发送消息。</p><p>为了发送消息，那就得先知道往哪发。linux里万物皆文件，那你要发消息的目的地，也是个文件，这里就引出了socket 的概念。</p><p>要使用 <code>socket</code> , 那么首先需要创建它。</p><p>在 TCP 传输中创建的方式是 <code>socket(AF_INET, SOCK_STREAM, 0);</code>，其中 <code>AF_INET</code> 表示将使用 IPV4 里 <strong>host:port</strong> 的方式去解析待会你输入的网络地址。<code>SOCK_STREAM</code> 是指使用面向字节流的 TCP 协议，<strong>工作在传输层</strong>。</p><p>创建好了 <code>socket</code> 之后，就可以愉快的把要传输的数据写到这个文件里。调用 socket 的<code>sendto</code>接口的过程中进程会从<strong>用户态进入到内核态</strong>，最后会调用到 <code>sock_sendmsg</code> 方法。</p><p>然后进入传输层，带上<code>TCP</code>头。网络层带上<code>IP</code>头，数据链路层带上 <code>MAC</code>头等一系列操作后。进入网卡的<strong>发送队列 ring buffer</strong> ，顺着网卡就发出去了。</p><p>回到 <code>ping</code> ， 整个过程也基本跟 <code>TCP</code> 发数据类似，差异的地方主要在于，创建 <code>socket</code> 的时候用的是 <code>socket(AF_INET,SOCK_RAW,IPPROTO_ICMP)</code>，<code>SOCK_RAW</code> 是原始套接字 ，<strong>工作在网络层</strong>， 所以构建<code>ICMP</code>（网络层协议）的数据，是再合适不过了。ping 在进入内核态后最后也是调用的 <code>sock_sendmsg</code> 方法，进入到网络层后加上<strong>ICMP和IP头</strong>后，数据链路层加上<strong>MAC头</strong>，也是顺着网卡发出。因此 本质上ping 跟 普通应用发消息 在程序流程上没太大差别。</p><p>这也解释了<strong>为什么当你发现怀疑网络有问题的时候，别人第一时间是问你能ping通吗？</strong> 因为可以简单理解为ping就是自己组了个数据包，让系统按着其他软件发送数据的路径往外发一遍，能通的话说明其他软件发的数据也能通。</p><h2 id="为什么断网了还能-ping-通-127-0-0-1" tabindex="-1"><a class="header-anchor" href="#为什么断网了还能-ping-通-127-0-0-1" aria-hidden="true">#</a> 为什么断网了还能 ping 通 127.0.0.1</h2><p>前面提到，有网的情况下，ping 最后是<strong>通过网卡</strong>将数据发送出去的。</p><p>那么断网的情况下，网卡已经不工作了，ping 回环地址却一切正常，我们可以看下这种情况下的工作原理。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/c1019a8be584b27c4fc8b8abda9d3cf1.png" alt="图片"></p><p>从应用层到传输层再到网络层。这段路径跟ping外网的时候是几乎是一样的。到了网络层，系统会根据目的IP，在路由表中获取对应的<strong>路由信息</strong>，而这其中就包含选择<strong>哪个网卡</strong>把消息发出。</p><p>当发现<strong>目标IP是外网IP</strong>时，会从&quot;真网卡&quot;发出。</p><p>当发现<strong>目标IP是回环地址</strong>时，就会选择<strong>本地网卡</strong>。</p><p>本地网卡，其实就是个 <strong>&quot;</strong> <strong>假网卡</strong> <strong>&quot;</strong>，它不像&quot;真网卡&quot;那样有个<code>ring buffer</code>什么的，&quot;假网卡&quot;会把数据推到一个叫 <code>input_pkt_queue</code> 的 <strong>链表</strong> 中。这个链表，其实是所有网卡共享的，上面挂着发给本机的各种消息。消息被发送到这个链表后，会再触发一个<strong>软中断</strong>。</p><p>专门处理软中断的工具人 <strong>&quot;</strong> <strong>ksoftirqd</strong> <strong>&quot;</strong>（这是个<strong>内核线程</strong>），它在收到软中断后就会立马去链表里把消息取出，然后顺着数据链路层、网络层等层层往上传递最后给到应用程序。</p><p><img src="https://img-blog.csdnimg.cn/img_convert/a207c14a5416f44e9dbf0fe0a41179e4.png" alt="图片"></p><p>ping 回环地址和<strong>通过TCP等各种协议发送数据到回环地址</strong>都是走这条路径。整条路径从发到收，都没有经过&quot;真网卡&quot;。<strong>之所以127.0.0.1叫本地回环地址，可以理解为，消息发出到这个地址上的话，就不会出网络，在本机打个转就又回来了。</strong> 所以断网，依然能 <code>ping</code> 通 <code>127.0.0.1</code>。</p><h2 id="ping回环地址和ping本机地址有什么区别" tabindex="-1"><a class="header-anchor" href="#ping回环地址和ping本机地址有什么区别" aria-hidden="true">#</a> ping回环地址和ping本机地址有什么区别</h2><p>我们在mac里执行 <code>ifconfig</code> 。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ifconfig</span>
lo0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">804</span><span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span>UP,LOOPBACK,RUNNING,MULTICAST<span class="token operator">&gt;</span> mtu <span class="token number">16384</span>
    inet <span class="token number">127.0</span>.0.1 netmask 0xff000000
    <span class="token punctuation">..</span>.
en0: <span class="token assign-left variable">flags</span><span class="token operator">=</span><span class="token number">886</span><span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span>UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST<span class="token operator">&gt;</span> mtu <span class="token number">1500</span>
    inet <span class="token number">192.168</span>.31.6 netmask 0xffffff00 broadcast <span class="token number">192.168</span>.31.255
    <span class="token punctuation">..</span>.
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>能看到 <strong>lo0</strong>，表示本地回环接口，对应的地址，就是我们前面提到的 <strong>127.0.0.1</strong> ，也就是<strong>回环地址</strong>。</p><p>和 <strong>eth0</strong>，表示本机第一块网卡，对应的IP地址是<strong>192.168.31.6</strong>，管它叫<strong>本机IP</strong>。</p><p>之前一直认为ping本机IP的话会通过&quot;真网卡&quot;出去，然后遇到第一个路由器，再发回来到本机。</p><p>为了验证这个说法，可以进行抓包，但结果跟上面的说法并不相同。</p><p>ping 127.0.0.1:</p><p><img src="https://img-blog.csdnimg.cn/img_convert/bc2765b1d6d3e37a5663f98085198926.png" alt="图片"></p><p>ping 本机地址:</p><p><img src="https://img-blog.csdnimg.cn/img_convert/50cd584f9f82aee8d3d9bfaf7d910cb8.png" alt="图片"></p><p>可以看到 ping 本机IP 跟 ping 回环地址一样，相关的网络数据，都是走的 <strong>lo0</strong>，本地回环接口，也就是前面提到的**&quot;假网卡&quot;**。</p><p>只要走了本地回环接口，那数据都不会发送到网络中，在本机网络协议栈中兜一圈，就发回来了。因此 <strong>ping回环地址和ping本机地址没有区别</strong>。</p><h2 id="_127-0-0-1-和-localhost-以及-0-0-0-0-有区别吗" tabindex="-1"><a class="header-anchor" href="#_127-0-0-1-和-localhost-以及-0-0-0-0-有区别吗" aria-hidden="true">#</a> 127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗</h2><p>回到文章开头动图里的提问，算是面试八股文里的老常客了。</p><p>以前第一次用 <code>nginx</code> 的时候，发现用这几个 <code>IP</code>，都能正常访问到 <code>nginx</code> 的欢迎网页。一度认为这几个 <code>IP</code> 都是一样的。</p><p>访问127.0.0.1:80</p><p><img src="https://img-blog.csdnimg.cn/img_convert/12e13316a18009ce8b2983846819e270.png" alt="图片"></p><p>访问localhost:80</p><p><img src="https://img-blog.csdnimg.cn/img_convert/2c35f573e91e94733d009384a4657859.png" alt="图片"></p><p>访问0.0.0.0:80</p><p><img src="https://img-blog.csdnimg.cn/img_convert/ba534fdc5f21b3ab26d0b8c890bb02c3.png" alt="图片"></p><p>访问本机的IP地址</p><p><img src="https://img-blog.csdnimg.cn/img_convert/9b31572ced19805fab02a23b22819b92.png" alt="图片"></p><p>但本质上还是有些区别的。</p><p>首先 <code>localhost</code> 就不叫 <code>IP</code>，它是一个域名，就跟 <code>&quot;baidu.com&quot;</code>,是一个形式的东西，只不过默认会把它解析为 <code>127.0.0.1</code> ，当然这可以在 <code>/etc/hosts</code> 文件下进行修改。</p><p>所以默认情况下，使用 <code>localhost</code> 跟使用 <code>127.0.0.1</code> 确实是没区别的。</p><p>其次就是 <code>0.0.0.0</code>，执行 ping 0.0.0.0 ，是会失败的，因为它在<code>IPV4</code>中表示的是无效的<strong>目标地址</strong>。</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">ping</span> <span class="token number">0.0</span>.0.0
PING <span class="token number">0.0</span>.0.0 <span class="token punctuation">(</span><span class="token number">0.0</span>.0.0<span class="token punctuation">)</span>: <span class="token number">56</span> data bytes
ping: sendto: No route to <span class="token function">host</span>
ping: sendto: No route to <span class="token function">host</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>但它还是很有用处的，回想下，我们启动服务器的时候，一般会 <code>listen</code> 一个 IP 和端口，等待客户端的连接。</p><p>如果此时 <code>listen</code> 的是本机的 <code>0.0.0.0</code> , 那么它表示本机上的<strong>所有IPV4地址</strong>。</p><div class="language-c ext-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">/* Address to accept any incoming messages. */</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span>    <span class="token macro-name">INADDR_ANY</span>      <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">long</span> <span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token number">0x00000000</span><span class="token punctuation">)</span> </span><span class="token comment">/* 0.0.0.0   */</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>举个例子。刚刚提到的 <code>127.0.0.1</code> 和 <code>192.168.31.6</code> ，都是本机的IPV4地址，如果监听 <code>0.0.0.0</code> ，那么用上面两个地址，都能访问到这个服务器。</p><p>当然， 客户端 <code>connect</code> 时，不能使用 <code>0.0.0.0</code> 。必须指明要连接哪个服务器IP。</p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><ul><li><code>127.0.0.1</code> 是<strong>回环地址</strong>。<code>localhost</code>是<strong>域名</strong>，但默认等于 <code>127.0.0.1</code>。</li><li><code>ping</code> 回环地址和 <code>ping</code> 本机地址，是一样的，走的是<strong>lo0 &quot;假网卡&quot;</strong>，都会经过网络层和数据链路层等逻辑，最后在快要出网卡前<strong>狠狠拐了个弯</strong>， 将数据插入到一个<strong>链表</strong>后就<strong>软中断</strong>通知 <strong>ksoftirqd</strong> 来进行<strong>收数据</strong>的逻辑，<strong>压根就不出网络</strong>。所以断网了也能 <code>ping</code> 通回环地址。</li><li>如果服务器 <code>listen</code> 的是 <code>0.0.0.0</code>，那么此时用<code>127.0.0.1</code>和本机地址<strong>都可以</strong>访问到服务。</li></ul><hr></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1453300745@qq.com">wangtao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.c62ce33e.js" defer></script>
  </body>
</html>
