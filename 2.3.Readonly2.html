<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.51">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>3:Readonly2 | </title><meta name="description" content="">
    <link rel="modulepreload" href="/assets/app.3a074da4.js"><link rel="modulepreload" href="/assets/2.3.Readonly2.html.73ea1c5c.js"><link rel="modulepreload" href="/assets/2.3.Readonly2.html.35981333.js"><link rel="prefetch" href="/assets/1.1.hello-world.html.2f51439c.js"><link rel="prefetch" href="/assets/1.10.if.html.17d4f463.js"><link rel="prefetch" href="/assets/1.11.includes.html.cd510b9b.js"><link rel="prefetch" href="/assets/1.12.parameters.html.2159eb87.js"><link rel="prefetch" href="/assets/1.13.push.html.39d4f9ee.js"><link rel="prefetch" href="/assets/1.14.unshift.html.3439eb57.js"><link rel="prefetch" href="/assets/1.2.Pick.html.b59bc144.js"><link rel="prefetch" href="/assets/1.3.Awaited.html.ff3d3003.js"><link rel="prefetch" href="/assets/1.4.Readonly.html.66bec4c3.js"><link rel="prefetch" href="/assets/1.5.Tuple-to-object.html.073fc352.js"><link rel="prefetch" href="/assets/1.6.First-of-array.html.23794c82.js"><link rel="prefetch" href="/assets/1.7.Length-of-Tuple.html.a8ffb192.js"><link rel="prefetch" href="/assets/1.8.concat.html.a113642f.js"><link rel="prefetch" href="/assets/1.9.exclude.html.b3f8155f.js"><link rel="prefetch" href="/assets/2.1.Get-Return-Type.html.5b4fc316.js"><link rel="prefetch" href="/assets/2.2.omit.html.46806c90.js"><link rel="prefetch" href="/assets/2.4.Deep-Readonly.html.f0a1f464.js"><link rel="prefetch" href="/assets/2.5.turn-to-union.html.dac08986.js"><link rel="prefetch" href="/assets/3.1.Simple-Vue.html.cfc6a28f.js"><link rel="prefetch" href="/assets/basic-1.html.39ebf498.js"><link rel="prefetch" href="/assets/basic-2.html.ebc9fd69.js"><link rel="prefetch" href="/assets/basic-3.html.0ca4c8e2.js"><link rel="prefetch" href="/assets/http-2.html.95069c62.js"><link rel="prefetch" href="/assets/http-3.html.cd04c82d.js"><link rel="prefetch" href="/assets/http-interview.html.c784af51.js"><link rel="prefetch" href="/assets/http-optimize.html.2f9bc246.js"><link rel="prefetch" href="/assets/http-rpc.html.8a6b850b.js"><link rel="prefetch" href="/assets/http-websocket.html.fefabd18.js"><link rel="prefetch" href="/assets/https-ecdhe.html.deb46a30.js"><link rel="prefetch" href="/assets/https-optimize.html.59cca082.js"><link rel="prefetch" href="/assets/https-rsa.html.51623a46.js"><link rel="prefetch" href="/assets/ip-base.html.d4ccd278.js"><link rel="prefetch" href="/assets/ip-ping.html.b1f4bcea.js"><link rel="prefetch" href="/assets/ip-ping_io.html.541ce16f.js"><link rel="prefetch" href="/assets/tcp-challenge-ack.html.ffeec4f3.js"><link rel="prefetch" href="/assets/tcp-dump.html.efec7cda.js"><link rel="prefetch" href="/assets/tcp-feature.html.d2c602a3.js"><link rel="prefetch" href="/assets/tcp-interview.html.93b0fdd4.js"><link rel="prefetch" href="/assets/tcp-isn-deff.html.7fc20cff.js"><link rel="prefetch" href="/assets/tcp-optimize.html.623c649a.js"><link rel="prefetch" href="/assets/tcp-out-of-order-fin.html.449ebd74.js"><link rel="prefetch" href="/assets/tcp-queue.html.4f71e2cf.js"><link rel="prefetch" href="/assets/tcp-stream.html.ee8756fb.js"><link rel="prefetch" href="/assets/tcp-syn.html.a2fbac88.js"><link rel="prefetch" href="/assets/donate.html.961368cd.js"><link rel="prefetch" href="/assets/Routine1_pattern-matching-for-extraction.html.56963a82.js"><link rel="prefetch" href="/assets/Advanced-1.html.f57f9060.js"><link rel="prefetch" href="/assets/Advanced-2.html.e9103c17.js"><link rel="prefetch" href="/assets/Advanced-3.html.3793759e.js"><link rel="prefetch" href="/assets/Advanced-4.html.898bf6b6.js"><link rel="prefetch" href="/assets/Advanced-5.html.00d52f38.js"><link rel="prefetch" href="/assets/Extended-article-1.html.fab6e63d.js"><link rel="prefetch" href="/assets/base-1.html.7b2573da.js"><link rel="prefetch" href="/assets/base-10.html.e41deff3.js"><link rel="prefetch" href="/assets/base-11.html.c4cb2d9f.js"><link rel="prefetch" href="/assets/base-12.html.13bff5ee.js"><link rel="prefetch" href="/assets/base-13.html.7e441658.js"><link rel="prefetch" href="/assets/base-14.html.3e4d8532.js"><link rel="prefetch" href="/assets/base-15.html.f1e1d13f.js"><link rel="prefetch" href="/assets/base-16.html.63add677.js"><link rel="prefetch" href="/assets/base-17.html.9d73d4c7.js"><link rel="prefetch" href="/assets/base-2.html.893b18a3.js"><link rel="prefetch" href="/assets/base-3.html.e6617e04.js"><link rel="prefetch" href="/assets/base-4.html.513dbea8.js"><link rel="prefetch" href="/assets/base-5.html.40d14ecb.js"><link rel="prefetch" href="/assets/base-6.html.5b0fa07f.js"><link rel="prefetch" href="/assets/base-7.html.5b19c6f9.js"><link rel="prefetch" href="/assets/base-8.html.e0c26be4.js"><link rel="prefetch" href="/assets/base-9.html.8398e418.js"><link rel="prefetch" href="/assets/rollup-1.html.320df097.js"><link rel="prefetch" href="/assets/rollup-10.html.6e420b35.js"><link rel="prefetch" href="/assets/rollup-11.html.ded183c5.js"><link rel="prefetch" href="/assets/rollup-2.html.53982b31.js"><link rel="prefetch" href="/assets/rollup-3.html.fa852f4a.js"><link rel="prefetch" href="/assets/rollup-4.html.6e964868.js"><link rel="prefetch" href="/assets/rollup-5.html.d93d5225.js"><link rel="prefetch" href="/assets/rollup-6.html.77224b5c.js"><link rel="prefetch" href="/assets/rollup-7.html.253f8a66.js"><link rel="prefetch" href="/assets/rollup-8.html.303cd98d.js"><link rel="prefetch" href="/assets/rollup-9.html.1f7d5428.js"><link rel="prefetch" href="/assets/scope-closures-appA.html.4247cff9.js"><link rel="prefetch" href="/assets/scope-closures-appB.html.cc173c88.js"><link rel="prefetch" href="/assets/scope-closures-appC.html.eee76227.js"><link rel="prefetch" href="/assets/this-object-prototype-appA.html.b5826a90.js"><link rel="prefetch" href="/assets/async-performance-apA.html.73fe9b81.js"><link rel="prefetch" href="/assets/async-performance-apB.html.a3282496.js"><link rel="prefetch" href="/assets/async-performance-ch1.html.d5ff5d19.js"><link rel="prefetch" href="/assets/async-performance-ch2.html.5c702910.js"><link rel="prefetch" href="/assets/async-performance-ch3.html.741f3f32.js"><link rel="prefetch" href="/assets/async-performance-ch4.html.773838c8.js"><link rel="prefetch" href="/assets/async-performance-ch5.html.5b25dd7e.js"><link rel="prefetch" href="/assets/async-performance-ch6.html.e396043d.js"><link rel="prefetch" href="/assets/types-grammar-1.html.30426f08.js"><link rel="prefetch" href="/assets/types-grammar-2.html.dc601ece.js"><link rel="prefetch" href="/assets/types-grammar-3.html.d56cf893.js"><link rel="prefetch" href="/assets/types-grammar-4.html.c6425b24.js"><link rel="prefetch" href="/assets/types-grammar-5.html.721bd170.js"><link rel="prefetch" href="/assets/types-grammar-apA.html.765425aa.js"><link rel="prefetch" href="/assets/404.html.d2dc3323.js"><link rel="prefetch" href="/assets/1.1.hello-world.html.dbb990f2.js"><link rel="prefetch" href="/assets/1.10.if.html.ae82d89d.js"><link rel="prefetch" href="/assets/1.11.includes.html.fa3c56b2.js"><link rel="prefetch" href="/assets/1.12.parameters.html.1943cca3.js"><link rel="prefetch" href="/assets/1.13.push.html.f8ed0d03.js"><link rel="prefetch" href="/assets/1.14.unshift.html.22b62912.js"><link rel="prefetch" href="/assets/1.2.Pick.html.76240b85.js"><link rel="prefetch" href="/assets/1.3.Awaited.html.d5e5c07d.js"><link rel="prefetch" href="/assets/1.4.Readonly.html.3213ed76.js"><link rel="prefetch" href="/assets/1.5.Tuple-to-object.html.a497f83c.js"><link rel="prefetch" href="/assets/1.6.First-of-array.html.2d219f76.js"><link rel="prefetch" href="/assets/1.7.Length-of-Tuple.html.90af7747.js"><link rel="prefetch" href="/assets/1.8.concat.html.d4c5dc29.js"><link rel="prefetch" href="/assets/1.9.exclude.html.fde650b6.js"><link rel="prefetch" href="/assets/2.1.Get-Return-Type.html.2a0fbf33.js"><link rel="prefetch" href="/assets/2.2.omit.html.c1029f82.js"><link rel="prefetch" href="/assets/2.4.Deep-Readonly.html.1e19e1d7.js"><link rel="prefetch" href="/assets/2.5.turn-to-union.html.6d02e300.js"><link rel="prefetch" href="/assets/3.1.Simple-Vue.html.cf7d2114.js"><link rel="prefetch" href="/assets/basic-1.html.2d1468f2.js"><link rel="prefetch" href="/assets/basic-2.html.03e8f1b3.js"><link rel="prefetch" href="/assets/basic-3.html.c37bc75e.js"><link rel="prefetch" href="/assets/http-2.html.32675791.js"><link rel="prefetch" href="/assets/http-3.html.b67adbbe.js"><link rel="prefetch" href="/assets/http-interview.html.eaae0aae.js"><link rel="prefetch" href="/assets/http-optimize.html.eaf809c2.js"><link rel="prefetch" href="/assets/http-rpc.html.d87186f3.js"><link rel="prefetch" href="/assets/http-websocket.html.f0ade5b8.js"><link rel="prefetch" href="/assets/https-ecdhe.html.c14d0a68.js"><link rel="prefetch" href="/assets/https-optimize.html.7ea0e6ab.js"><link rel="prefetch" href="/assets/https-rsa.html.fa73904d.js"><link rel="prefetch" href="/assets/ip-base.html.7de5ae2f.js"><link rel="prefetch" href="/assets/ip-ping.html.dd631318.js"><link rel="prefetch" href="/assets/ip-ping_io.html.87cc138a.js"><link rel="prefetch" href="/assets/tcp-challenge-ack.html.14df771a.js"><link rel="prefetch" href="/assets/tcp-dump.html.e0116aab.js"><link rel="prefetch" href="/assets/tcp-feature.html.014a5c06.js"><link rel="prefetch" href="/assets/tcp-interview.html.a3e5e864.js"><link rel="prefetch" href="/assets/tcp-isn-deff.html.4a06d474.js"><link rel="prefetch" href="/assets/tcp-optimize.html.c2ecb4b3.js"><link rel="prefetch" href="/assets/tcp-out-of-order-fin.html.85ec8406.js"><link rel="prefetch" href="/assets/tcp-queue.html.e2659d5c.js"><link rel="prefetch" href="/assets/tcp-stream.html.488aa6a5.js"><link rel="prefetch" href="/assets/tcp-syn.html.d9de5837.js"><link rel="prefetch" href="/assets/donate.html.f2bccb7b.js"><link rel="prefetch" href="/assets/Routine1_pattern-matching-for-extraction.html.c689d376.js"><link rel="prefetch" href="/assets/Advanced-1.html.d5ab5803.js"><link rel="prefetch" href="/assets/Advanced-2.html.6c4f8a18.js"><link rel="prefetch" href="/assets/Advanced-3.html.3c98b11c.js"><link rel="prefetch" href="/assets/Advanced-4.html.cc999ef3.js"><link rel="prefetch" href="/assets/Advanced-5.html.87eea8ef.js"><link rel="prefetch" href="/assets/Extended-article-1.html.1afe326e.js"><link rel="prefetch" href="/assets/base-1.html.143ededb.js"><link rel="prefetch" href="/assets/base-10.html.ddc9fcf0.js"><link rel="prefetch" href="/assets/base-11.html.68c2cd09.js"><link rel="prefetch" href="/assets/base-12.html.2a3fb063.js"><link rel="prefetch" href="/assets/base-13.html.b3cfd0b4.js"><link rel="prefetch" href="/assets/base-14.html.b3907d4d.js"><link rel="prefetch" href="/assets/base-15.html.754606f1.js"><link rel="prefetch" href="/assets/base-16.html.c06a55f8.js"><link rel="prefetch" href="/assets/base-17.html.f732ccd5.js"><link rel="prefetch" href="/assets/base-2.html.4d000639.js"><link rel="prefetch" href="/assets/base-3.html.5bc479b8.js"><link rel="prefetch" href="/assets/base-4.html.1c042615.js"><link rel="prefetch" href="/assets/base-5.html.c21b64d7.js"><link rel="prefetch" href="/assets/base-6.html.197e9beb.js"><link rel="prefetch" href="/assets/base-7.html.2487bb3e.js"><link rel="prefetch" href="/assets/base-8.html.b525a8c6.js"><link rel="prefetch" href="/assets/base-9.html.f20763fd.js"><link rel="prefetch" href="/assets/rollup-1.html.26e3f8ec.js"><link rel="prefetch" href="/assets/rollup-10.html.74c99754.js"><link rel="prefetch" href="/assets/rollup-11.html.7a900bc3.js"><link rel="prefetch" href="/assets/rollup-2.html.8d9b4f20.js"><link rel="prefetch" href="/assets/rollup-3.html.d2ea99d8.js"><link rel="prefetch" href="/assets/rollup-4.html.c3b9d0f7.js"><link rel="prefetch" href="/assets/rollup-5.html.c4ce792b.js"><link rel="prefetch" href="/assets/rollup-6.html.3fa77458.js"><link rel="prefetch" href="/assets/rollup-7.html.92b371ea.js"><link rel="prefetch" href="/assets/rollup-8.html.f9929e81.js"><link rel="prefetch" href="/assets/rollup-9.html.e114323d.js"><link rel="prefetch" href="/assets/scope-closures-appA.html.36941822.js"><link rel="prefetch" href="/assets/scope-closures-appB.html.88591296.js"><link rel="prefetch" href="/assets/scope-closures-appC.html.1330c55e.js"><link rel="prefetch" href="/assets/this-object-prototype-appA.html.79d1d032.js"><link rel="prefetch" href="/assets/async-performance-apA.html.f8027894.js"><link rel="prefetch" href="/assets/async-performance-apB.html.f0742808.js"><link rel="prefetch" href="/assets/async-performance-ch1.html.fe31721c.js"><link rel="prefetch" href="/assets/async-performance-ch2.html.8cc20d2a.js"><link rel="prefetch" href="/assets/async-performance-ch3.html.30e7d7d6.js"><link rel="prefetch" href="/assets/async-performance-ch4.html.d1fae809.js"><link rel="prefetch" href="/assets/async-performance-ch5.html.1bb99263.js"><link rel="prefetch" href="/assets/async-performance-ch6.html.532f5a8f.js"><link rel="prefetch" href="/assets/types-grammar-1.html.2a677751.js"><link rel="prefetch" href="/assets/types-grammar-2.html.ff0413a9.js"><link rel="prefetch" href="/assets/types-grammar-3.html.ab543605.js"><link rel="prefetch" href="/assets/types-grammar-4.html.7f61c946.js"><link rel="prefetch" href="/assets/types-grammar-5.html.ca0b5d4b.js"><link rel="prefetch" href="/assets/types-grammar-apA.html.d1511322.js"><link rel="prefetch" href="/assets/404.html.92978749.js">
    <link rel="stylesheet" href="/assets/style.f4d22aab.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><!--v-if--></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">3:Readonly2 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/challenge/2.3.Readonly2.html#题目" class="router-link-active router-link-exact-active sidebar-item" aria-label="题目"><!--[--><!--]--> 题目 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/challenge/2.3.Readonly2.html#挑战" class="router-link-active router-link-exact-active sidebar-item" aria-label="挑战"><!--[--><!--]--> 挑战 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/challenge/2.3.Readonly2.html#解析" class="router-link-active router-link-exact-active sidebar-item" aria-label="解析"><!--[--><!--]--> 解析 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/challenge/2.3.Readonly2.html#参考" class="router-link-active router-link-exact-active sidebar-item" aria-label="参考"><!--[--><!--]--> 参考 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="题目" tabindex="-1"><a class="header-anchor" href="#题目" aria-hidden="true">#</a> 题目</h2><p>实现一个通用 <code>MyReadonly2&lt;T, K&gt;</code>，它带有两种类型的参数 <code>T</code> 和 <code>K</code>。</p><p><code>K</code> 指定应设置为 <code>Readonly</code> 的 <code>T</code> 的属性集。如果未提供<code> K</code>，则应使所有属性都变为只读，就像普通的 <code>Readonly&lt;T&gt;</code>一样。</p><p>例如：</p><div class="language-typescript ext-ts line-numbers-mode"><pre class="language-typescript"><code><span class="token keyword">interface</span> <span class="token class-name">Todo</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  completed<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> todo<span class="token operator">:</span> MyReadonly2<span class="token operator">&lt;</span>Todo<span class="token punctuation">,</span> <span class="token string">&quot;title&quot;</span> <span class="token operator">|</span> <span class="token string">&quot;description&quot;</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">&quot;Hey&quot;</span><span class="token punctuation">,</span>
  description<span class="token operator">:</span> <span class="token string">&quot;foobar&quot;</span><span class="token punctuation">,</span>
  completed<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

todo<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span> <span class="token comment">// Error: cannot reassign a readonly property</span>
todo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;barFoo&quot;</span><span class="token punctuation">;</span> <span class="token comment">// Error: cannot reassign a readonly property</span>
todo<span class="token punctuation">.</span>completed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// OK</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p align="left"> 点击github查看： <a href="https://github.com/W-HanYu/FE-Typescript/blob/master/vuepress/docs/challenge/2.3.Readonly2.md"><img src="https://img.shields.io/badge/Github-1.8k+-143?logo=typescript&amp;color=3178C6&amp;logoColor=fff"></a></p><h2 id="挑战" tabindex="-1"><a class="header-anchor" href="#挑战" aria-hidden="true">#</a> 挑战</h2><p>::: info 提示 在这个挑战中，你需要修改下方的代码使得测试通过（使其没有类型错误）。并且记得将答案分享奥。 :::</p><!----><!--info-footer-start--><br> <a href="https://github.com/W-HanYu/FE-Typescript/issues/new?assignees=Ustinian&amp;labels=answer&amp;template=2-3-%E5%AE%9E%E7%8E%B0Readonly2.md&amp;title=2-3-%E5%AE%9E%E7%8E%B0Readonly2.md" target="_blank"><img src="https://6d78-mxm1923893223-ulteh-1302287111.tcb.qcloud.la/-分享你的解答-teal.svg?sign=8bb2a2a3bd2b1cc8f86bfd919d53197e&amp;t=1668143704" alt="分享你的解答"></a><!--info-footer-end--><h2 id="解析" tabindex="-1"><a class="header-anchor" href="#解析" aria-hidden="true">#</a> 解析</h2><p>这个挑战是 <code>Readonly&lt;T&gt;</code>挑战的延续，除了需要添加一个新的类型参数 <code>K</code>，以便我们可以 将指定的属性设为只读外，一切都基本相同。</p><p>我们从最简单的例子开始，即 K 是一个空集合，因此没有任何属性需要设置为只读。我们 只需要返回 T 就好了。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>现在我们需要处理这样一种情况：即在 K 中提供对应属性，我们利用&amp;操作符使两种类型 产 生交集： 一个是之前提到的类型 T,另一个是含有只读属性的类型。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> readonly <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>看起来是一种解决方案，但是我们得到一个编译错误 <code>：Type P cannot be used to index type T</code>。这是对的，因为我们没有对 K 设置约 束，它应该是 <code>“T 中的每一个键”</code> :</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span> readonly <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>正常工作啦? 🙅‍ 不!</p><p>我们还没有处理当 K 什么都没有设置的情况，该情况下我们的类型必须和通常 的 <code>Readonly&lt;T&gt;</code>表现得一样。为了修复这个问题，我们将 K 的默认值设为”T 的所有键 “。</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// solution-1</span>
type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span> <span class="token operator">=</span> keyof <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token constant">T</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
readonly <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 即：</span>
type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span> <span class="token operator">=</span> keyof <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> Readonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>你可能发现 solution-1 在 TypeScript 4.5 及以上的版本中不能正常工作，因为原本的行 为在 <code>TypeScript</code> 中是一个 bug（ 在 microsoft/TypeScript#45122 中 列出， 在 <code>microsoft/TypeScript#45263</code> 中 被修复，在 TypeScript 4.5 版本中正式发布）。从概念上来说，交叉类型意味着 “与”， 因此{readonly a: string} &amp; {a: string}与{a: string}应该是相等的，也就是说属 性 a 是可读且可写的。</p><p>在 TypeScript 4.5 之前， TypeScript 有着相反的不正确的行为，也就是说在交叉类型中 ，一些成员的属性是只读的，但在另外成员中同名属性是可读可写的，最终对象的相应属性 却是只读的，这种行为是不正确的，但这已经被修复了。因此这也就解释了为什 么 solution-1 不能正常工作。想要解决这个问题，可以像下面这样写：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//Solution-2</span>
type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span> <span class="token operator">=</span> keyof <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>
readonly <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token constant">K</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//i.e.</span>
type MyReadonly2<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span> <span class="token keyword">extends</span> <span class="token class-name">keyof</span> <span class="token constant">T</span> <span class="token operator">=</span> keyof <span class="token constant">T</span><span class="token operator">&gt;</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">,</span> <span class="token constant">K</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> Readonly<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>因为 K 中的键都没有在 <code>keyof Omit&lt;T, K&gt;</code>中出现过，因此 <code>solution-2</code> 能够向相应属性 添加 <code>readonly</code> 修饰符。</p><h2 id="参考" tabindex="-1"><a class="header-anchor" href="#参考" aria-hidden="true">#</a> 参考</h2><ul><li><a href="https://www.typescriptlang.org/docs/handbook/2/conditional-types.html" target="_blank" rel="noopener noreferrer">Conditional Types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.typescriptlang.org/docs/handbook/2/mapped-types.html" target="_blank" rel="noopener noreferrer">Mapped Types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.typescriptlang.org/docs/handbook/2/indexed-access-types.html" target="_blank" rel="noopener noreferrer">Index Types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html#key-remapping-in-mapped-types" target="_blank" rel="noopener noreferrer">Key remapping in mapped types<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1453300745@qq.com">wangtao</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.3a074da4.js" defer></script>
  </body>
</html>
